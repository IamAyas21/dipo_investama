@model DIPO_INVESTAMA.Models.DashboardViewModels
@using (Html.BeginForm("Index", "Home", FormMethod.Post))
{
    <div class="row">
        <div class="col-lg-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div class="row">
                        <div class="col-sm-6">
                            <h4>Report of Bank</h4>
                        </div>
                        <div class="col-sm-6" align="right">
                            <button type="submit" name="Submit" value="PDF_ReportBank"><img src="~/Assets/icon/pdf.png" width="30" height="30" /></button>
                            <button type="submit" name="Submit" value="Excel_ReportBank"><img src="~/Assets/icon_xlxs.png" width="30" height="30" /></button>
                        </div>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-xs-4">
                            <label>Filter</label>
                            @Html.DropDownListFor(model => model.FilterReportBank, ViewBag.FilterBankList as SelectList, new { @class = "form-control" })
                        </div>
                        <div class="col-xs-4">
                            <label>Periode</label>
                            @Html.TextBoxFor(model => model.PeriodeReportBank, new { @class = "form-control pull-left", @placeholder = "Date", autocomplete = "off" })
                        </div>
                        <div class="col-xs-4">
                            <label>View by</label>
                            @Html.DropDownListFor(model => model.ViewByReportBank
                       , new List<SelectListItem>
                        {
                           new SelectListItem{ Text="Choose", Value = "" },
                           new SelectListItem{ Text="Monthly", Value = "Monthly" },
                           new SelectListItem{ Text="Yearly", Value = "Yearly" }
                        }, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="chart" id="areaChartBank"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div class="row">
                        <div class="col-sm-6">
                            <h4>Report of Account</h4>
                        </div>
                        <div class="col-sm-6" align="right">
                            <button type="submit" name="Submit" value="PDF_ReportAccount"><img src="~/Assets/icon/pdf.png" width="30" height="30" /></button>
                            <button type="submit" name="Submit" value="Excel_ReportAccount"><img src="~/Assets/icon_xlxs.png" width="30" height="30" /></button>
                        </div>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-xs-4">
                            <label>Filter</label>
                            @Html.DropDownListFor(model => model.FilterReportAccount, ViewBag.FilterAccountList as SelectList, new { @class = "form-control" })
                        </div>
                        <div class="col-xs-4">
                            <label>Periode</label>
                            @Html.TextBoxFor(model => model.PeriodeReportAccount, new { @class = "form-control pull-left", @placeholder = "Date", autocomplete = "off" })
                        </div>
                        <div class="col-xs-4">
                            <label>View by</label>
                            @Html.DropDownListFor(model => model.ViewByReportAccount
                       , new List<SelectListItem>
                        {
                           new SelectListItem{ Text="Choose", Value = "" },
                           new SelectListItem{ Text="Monthly", Value = "Monthly" },
                           new SelectListItem{ Text="Yearly", Value = "Yearly" }
                        }, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="chart" id="areaChartAccount"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div class="row">
                        <div class="col-sm-6">
                            <h4>Report of Account Cash In</h4>
                        </div>
                        <div class="col-sm-6" align="right">
                            <button type="submit" name="Submit" value="PDF_CashIn"><img src="~/Assets/icon/pdf.png" width="30" height="30" /></button>
                            <button type="submit" name="Submit" value="Excel_CashIn"><img src="~/Assets/icon_xlxs.png" width="30" height="30" /></button>
                        </div>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-xs-4">
                            <label>Filter</label>
                            @Html.DropDownListFor(model => model.FilterReportCashIn, ViewBag.FilterCashInList as SelectList, new { @class = "form-control" })
                        </div>
                        <div class="col-xs-4">
                            <label>Periode</label>
                            @Html.TextBoxFor(model => model.PeriodeReportCashIn, new { @class = "form-control pull-left", @placeholder = "Date", autocomplete = "off" })
                        </div>
                        <div class="col-xs-4">
                            <label>View by</label>
                            @Html.DropDownListFor(model => model.ViewByReportCashIn
                       , new List<SelectListItem>
                        {
                          new SelectListItem{ Text="Choose", Value = "" },
                           new SelectListItem{ Text="Monthly", Value = "Monthly" },
                           new SelectListItem{ Text="Yearly", Value = "Yearly" }
                        }, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="chart" id="areaChartCashIn"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="box box-primary">
                <div class="box-header with-border">
                    <div class="row">
                        <div class="col-sm-6">
                            <h4>Report of Account Cash Out</h4>
                        </div>
                        <div class="col-sm-6" align="right">
                            <button type="submit" name="Submit" value="PDF_CashOut"><img src="~/Assets/icon/pdf.png" width="30" height="30" /></button>
                            <button type="submit" name="Submit" value="Excel_CashOut"><img src="~/Assets/icon_xlxs.png" width="30" height="30" /></button>
                        </div>
                    </div>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-xs-4">
                            <label>Filter</label>
                            @Html.DropDownListFor(model => model.FilterReportCashOut, ViewBag.FilterCashOutList as SelectList, new { @class = "form-control" })
                        </div>
                        <div class="col-xs-4">
                            <label>Periode</label>
                            @Html.TextBoxFor(model => model.PeriodeReportCashOut, new { @class = "form-control pull-left", @placeholder = "Date", autocomplete = "off" })
                        </div>
                        <div class="col-xs-4">
                            <label>View by</label>
                            @Html.DropDownListFor(model => model.ViewByReportCashOut
                       , new List<SelectListItem>
                        {
                            new SelectListItem{ Text="Choose", Value = "" },
                           new SelectListItem{ Text="Monthly", Value = "Monthly" },
                           new SelectListItem{ Text="Yearly", Value = "Yearly" }
                        }, new { @class = "form-control" })
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-12">
                            <div class="chart" id="areaChartCashOut"></div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                        <div class="col-xs-3">

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

}
<script>
    $(function () {
        $('#PeriodeReportBank').daterangepicker({
            autoclose: true
        })
        $('#PeriodeReportBank').val("");

        $('#PeriodeReportAccount').daterangepicker({
            autoclose: true
        })
        $('#PeriodeReportAccount').val("");

        $('#PeriodeReportCashIn').daterangepicker({
            autoclose: true
        })
        $('#PeriodeReportCashIn').val("");

        $('#PeriodeReportCashOut').daterangepicker({
            autoclose: true
        })
        $('#PeriodeReportCashOut').val("");

        getReportOfBank();
        getReportOfAccount();
        getReportOfAccountCashIn();
        getReportOfAccountCashOut();

        ChangeMethod("FilterReportBank", "change", "ReportOfBank", "Home", "POST");
        ChangeMethod("PeriodeReportBank", "change", "ReportOfBank", "Home", "POST");
        ChangeMethod("ViewByReportBank", "change", "ReportOfBank", "Home", "POST");

        ChangeMethod("FilterReportAccount", "change", "ReportOfAccount", "Home", "POST");
        ChangeMethod("PeriodeReportAccount", "change", "ReportOfAccount", "Home", "POST");
        ChangeMethod("ViewByReportAccount", "change", "ReportOfAccount", "Home", "POST");

        ChangeMethod("FilterReportCashIn", "change", "ReportOfAccountCashIn", "Home", "POST");
        ChangeMethod("PeriodeReportCashIn", "change", "ReportOfAccountCashIn", "Home", "POST");
        ChangeMethod("ViewByReportCashIn", "change", "ReportOfAccountCashIn", "Home", "POST");

        ChangeMethod("FilterReportCashOut", "change", "ReportOfAccountCashOut", "Home", "POST");
        ChangeMethod("PeriodeReportCashOut", "change", "ReportOfAccountCashOut", "Home", "POST");
        ChangeMethod("ViewByReportCashOut", "change", "ReportOfAccountCashOut", "Home", "POST");
    });
    function getReportOfBank() {
        $.ajax({
            type: "POST",
            url: "@Url.Action("ReportOfBank", "Home")",
            data: { model: model() },
            success: function (response) {
                Morris1("areaChartBank", response);
            },
            error: function (response) {
                alert(response)
            }
        });
    }

    function getReportOfAccount() {
        $.ajax({
            type: "POST",
            url: "@Url.Action("ReportOfAccount", "Home")",
            success: function (response) {
                Morris1("areaChartAccount", response);
            },
            error: function (response) {
                alert(response)
            }
        });
    }

    function getReportOfAccountCashIn() {
        $.ajax({
            type: "POST",
            url: "@Url.Action("ReportOfAccountCashIn", "Home")",
            success: function (response) {
                Morris2("areaChartCashIn", response);
            },
            error: function (response) {
                alert(response)
            }
        });
    }

    function getReportOfAccountCashOut() {
        $.ajax({
            type: "POST",
            url: "@Url.Action("ReportOfAccountCashOut", "Home")",
            success: function (response) {
                Morris2("areaChartCashOut", response);
            },
            error: function (response) {
                alert(response)
            }
        });
    }

    function Morris1(id, model) {
        var area = new Morris.Area({
            element: id,
            resize: true,
            data: model,
            xkey: 'Month',
            ykeys: ['Cash_In', 'Cash_Out'],
            labels: ['Cash In', 'Cash Out'],
            lineColors: ['#a0d0e0', '#3c8dbc'],
            hideHover: 'auto'
        });
    }

    function Morris2(id, model) {
        var area = new Morris.Area({
            element: id,
            resize: true,
            data: model,
            xkey: 'Month',
            ykeys: ['Operation', 'Accounting'],
            labels: ['Operation', 'Accounting'],
            lineColors: ['#a0d0e0', '#3c8dbc'],
            hideHover: 'auto'
        });
    }

    function model() {
        return data =
        {
            FilterReportBank: $("#FilterReportBank").val(),
            PeriodeReportBank: $("#PeriodeReportBank").val(),
            ViewByReportBank: $("#ViewByReportBank").val(),
            FilterReportAccount: $("#FilterReportAccount").val(),
            PeriodeReportAccount: $("#PeriodeReportAccount").val(),
            ViewByReportAccount: $("#ViewByReportAccount").val(),
            FilterReportCashIn: $("#FilterReportCashIn").val(),
            PeriodeReportCashIn: $("#PeriodeReportCashIn").val(),
            ViewByReportCashIn: $("#ViewByReportCashIn").val(),
            FilterReportCashOut: $("#FilterReportCashOut").val(),
            PeriodeReportCashOut: $("#PeriodeReportCashOut").val(),
            ViewByReportCashOut: $("#ViewByReportCashOut").val()
        };
    }

    function ChangeMethod(id, event, action, controller, method) {
        $("#" + id).on(event, function () {
            $.ajax(
            {
                url: controller + "/" + action,
                type: method,
                data: { model: model() },
                success: function (response) {

                },
                error: function () {
                    alert("error");
                }
            });
        });
    }

</script>
